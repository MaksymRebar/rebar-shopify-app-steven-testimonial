{{ "slick.css" | asset_url | stylesheet_tag }}
{{ "slick-theme.css" | asset_url | stylesheet_tag }}
{{ "style.css" | asset_url | stylesheet_tag }}
<script src="https://google-review-app--development.gadget.app/api/client/web.min.js" ></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js" type="text/javascript" ></script>
<script src="https://code.jquery.com/jquery-migrate-3.4.0.min.js" ></script>
{{ "slick.js" | asset_url | script_tag }}
<section>
<div class="review-header" >
  <h2 >Our Customers</h2>
  {% comment %} <div style="min-width:10%;" ></div> {% endcomment %}
  <a id="review-link" href="" target="_blank" ><img class="review-logo" src="{{ 'google-logo.png' | asset_url }}" /></a>
</div>
<div id="review-container" class="regular slider">
</div>
</section>
{% comment %} <script src="https://static.elfsight.com/platform/platform.js" data-use-service-core defer></script>
<div class="elfsight-app-9b7f4c30-c93a-4fbe-af19-b3f93a827e79" data-elfsight-app-lazy></div> {% endcomment %}

<script>
  
  window.onload=async ()=>{
    window.api = new Gadget({
      environment: "Development",

    })
    const AppConfig=await api.AppConfig.findFirst();
    console.log(AppConfig)
    if(AppConfig.MyPlace){
      var review_link=document.getElementById('review-link');
      review_link.setAttribute('href',`https://search.google.com/local/writereview?placeid=${AppConfig.MyPlace}`)
    }
    var filter={
      rating:{greaterThanOrEqual:AppConfig.ShowRating}
    };
    if(AppConfig.ShowReview=="selected") filter.show={equals:true};
    api.Review.findMany({filter:filter})
    .then(response=>{
    if(!response.length) return;
    console.log(response)
    var reviewContainer=document.getElementById('review-container')
    response.map((oneReview,index)=>{
      reviewContainer.innerHTML+=`
        <div class="item slider-item" style="width:80%" >
          <div class="review-author">
            <img class="review-avatar" src="${oneReview.profile_photo_url?oneReview.profile_photo_url:""}" alt="image" />
            <div class="review-info"  >
              <h4 >${oneReview.author_name&&oneReview.author_name}</h4>
              <p>${oneReview.data&&AppConfig.ShowDate?oneReview.data.relative_time_description:""}</p>
            </div>
          </div>
            <div class="review-rating" >
              
                ${0<oneReview.rating?"★":"☆"}
                ${1<oneReview.rating?"★":"☆"}
                ${2<oneReview.rating?"★":"☆"}
                ${3<oneReview.rating?"★":"☆"}
                ${4<oneReview.rating?"★":"☆"}
            </div>
          <p class="review-text" >${oneReview.text}</p>
          <img style="float:right;width:10%;margin-right:10px;margin-bottom:10px;" src="{{ "google-icon.png" | asset_url }}" />
        </div>
      `;
    });
    $(".vertical-center-4").slick({
        dots: true,
        vertical: true,
        centerMode: true,
        slidesToShow: 4,
        slidesToScroll: 2
      });
      $(".vertical-center-3").slick({
        dots: true,
        vertical: true,
        centerMode: true,
        slidesToShow: 3,
        slidesToScroll: 3
      });
      $(".vertical-center-2").slick({
        dots: true,
        vertical: true,
        centerMode: true,
        slidesToShow: 2,
        slidesToScroll: 2
      });
      $(".vertical-center").slick({
        dots: true,
        vertical: true,
        centerMode: true,
      });
      $(".vertical").slick({
        dots: true,
        vertical: true,
        slidesToShow: 3,
        slidesToScroll: 3
      });
      $(".regular").slick({
        dots: true,
        infinite: true,
        slidesToShow: 4,
        slidesToScroll: 3,
        responsive: [
          {
          breakpoint: 1024,
          settings: {
            slidesToShow: 2,
            slidesToScroll: 2,
            infinite: true,
            dots: true
          }
        },
        {
          breakpoint: 600,
          settings: {
            slidesToShow: 1,
            slidesToScroll: 1
          }
        },
        {
          breakpoint: 480,
          settings: {
            slidesToShow: 1,
            slidesToScroll: 1
          }
        }
        // You can unslick at a given breakpoint now by adding:
        // settings: "unslick"
        // instead of a settings object
      ]
      });
      $(".center").slick({
        dots: true,
        infinite: true,
        centerMode: true,
        slidesToShow: 5,
        slidesToScroll: 3
      });
      $(".variable").slick({
        dots: true,
        infinite: true,
        variableWidth: true
      });
      $(".lazy").slick({
        lazyLoad: 'ondemand', // ondemand progressive anticipated
        infinite: true
      });
    
  });
  }
</script>
<script >
  $(document).on('ready', function() {
    
  });
</script>
{% schema %}
{
  "name": "Google Map Review Widget",
  "target": "section",
  "settings": [
    { "type": "product", "id": "product", "label": "product", "autofill": true },
    { "type": "color", "id": "colour", "label": "Star Colour", "default": "#ff0000" }
  ]
}
{% endschema %}

